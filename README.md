# Multiplicative Subgroup

```{rust}
pub fn multiplicative_subgroup(p: u64, n: u64) -> Result<Vec<u64>, Box<dyn std::error::Error>> {
if !crate::sanity_checks::is_prime(p, 5) {
return Err(Box::new(NotPrimeError));
}

        if (p - 1) % n != 0 {
            return Err(Box::new(NotFactorError));
        }
        // let mut rng = rand::thread_rng();
        let mut g = generate_candidate(p);
        while !is_generator(p, g) {
            g = generate_candidate(p);
        }
        let mut subgroup = HashSet::new();

        // we generate element in the subgroup by raising the generator to the power i((p-1)/n) mod p where i is in the range of 1 to n
        for i in 1..=n {
            subgroup.insert(mod_exp(g, i * ((p - 1) / n), p));
        }

        let mut subgroup = Vec::from_iter(subgroup);
        // rotate the list  until 1 is the first element in the list
        let index = subgroup.iter().position(|&x| x == 1).unwrap();
        subgroup.rotate_left(index);
        Ok(subgroup)
    }
```

This crate implements a multiplicative subgroup of integers modulo \( p \), where \( p \) is a prime number. The subgroup is generated by a primitive root modulo \( p \).

## Usage and implemantation

### Initialization

To use the multiplicative subgroup, you need to provide two inputs:

- **p**: a prime number.
- **n**: a factor of \( p - 1 \).

The crate checks if \( p \) is prime and if \( n \) is a factor of \( p - 1 \). If either condition is not met, it returns an error.

### Important Notes

- The crate cannot create a subgroup for a group whose modulo is not prime.
- The size of the subgroup must be a factor of \( p - 1 \), otherwise an error is returned.

## Generating a Primitive Root

Once the inputs are validated, the crate generates a primitive root modulo \( p \). This is done by randomly selecting a value \( x \) such that \( 2 \leq x \leq p - 2 \). The crate then checks if \( x \) is a primitive root by verifying that \( x^{(p-1)/\text{factor}} \neq 1 \mod p \) for all factors of \( p - 1 \). If \( x \) is a primitive root, it is returned as the generator of the subgroup. If not, another candidate is generated.

## Generating the Multiplicative Subgroup

Using a valid primitive root, the crate generates the multiplicative subgroup by computing the powers of the primitive root modulo \( p \).

## Implementation

The implementation of the multiplicative subgroup is based on the following steps:

1. Check if \( p \) is prime using a probabilistic primality test.
2. Check if \( n \) is a factor of \( p - 1 \) by computing the factors of \( p - 1 \).
3. Generate a primitive root modulo \( p \) by randomly selecting a value \( x \) and checking if \( x^{(p-1)/\text{factor}} \neq 1 \mod p \) for all factors of \( p - 1 \).
4. Compute the powers of the primitive root modulo \( p \) to generate the subgroup elements.

## Error Handling

The crate returns an error if:

- \( p \) is not a prime number.
- \( n \) is not a factor of \( p - 1 \).
- The primitive root cannot be generated.

## Documentation

The crate is fully documented with examples and usage instructions. You can find the documentation [here](#).

## License

The crate is licensed under the MIT License. See [LICENSE](#) for details.

```

```
